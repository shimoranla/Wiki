var Gmal=function(){"use strict";var e={on(e,t,n,a){e.addEventListener(t,n,a)},off(e,t,n){e.removeEventListener(t,n)}};const t=document,n=t.documentElement;function a(e){return`gmal-${e}`}function o(e,...n){const a=t.createElement(e);return a.classList.add(...n),a}function r(...e){return o("div",...e)}const i=()=>{let e=m(".gmal");return e||(e=r("gmal"),t.body.append(e)),e};function s(e,t){const n=e.style.cssText.split(";");n.pop(),e.style.cssText=`${n.concat(t).join(";")};`}function l(e,t){t.forEach((t=>{e.style.removeProperty(t)}))}function c(e=!0){const a=t.body;e?s(a,["overflow: hidden",`padding-right: ${window.innerWidth-n.clientWidth}px`]):l(a,["overflow","padding-right"])}function m(e,t=n){return t.querySelector(e)}function d(e){let t=m(`#${a("style")}`);t||(t=o("style"),t.id=a("style"),document.head.append(t)),t.innerHTML+=e}function g(t,n){e.on(t,"animationend",(e=>{n(e.animationName)}))}function f(e,t){l(e,["animation-name"]),e.offsetHeight,s(e,[`animation-name:${t}`])}d(".gmal{z-index:2019;color:var(--gmal-text);word-break:normal;word-wrap:break-word;--gmal-text:#5a5a5a;height:0;font:16px/1.3 Helvetica Neue,Helvetica,Arial,PingFang SC,Hiragino Sans GB,Heiti SC,Microsoft YaHei,WenQuanYi Micro Hei,sans-serif;position:fixed}.gmal *{box-sizing:border-box}.gmal-close{cursor:pointer;opacity:.3;border-radius:5px;font-size:1.5em;transition:all .2s;display:flex}.gmal-close:hover{background:var(--gmal-border-c);opacity:.5}.gmal-progress{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.gmal-progress .gmal-progress-bar{background:var(--gmal-bar-bg);width:0;height:100%;display:flex}");class p{constructor(e,t){this.conf={timeout:2500},this.id=0,this.insts=new Map,this.conf={...this.conf,...t},this.core=e}config(e){this.conf={...this.conf,...e}}fire(e){const t=this.mkMsg(e);return this.sT(t,null==e?void 0:e.timeout),t}sT(e,t){if(0===t)return;t=t||this.conf.timeout;const{$el:n}=e,a=this.mkP(e,t);a.resume(),n.onmouseenter=a.pause,n.onmouseleave=a.resume}mkP(e,t){const{$el:n}=e,o=r(a("progress")),i=r(a("progress-bar"));o.append(i),n.append(o),i.ontransitionend=()=>{e.close(-1)};const l=()=>i.clientWidth/o.clientWidth;return e.progress={pause:()=>{s(i,["transition:none",`width:${100*l()}%`])},resume:()=>{s(i,["width:100%",`transition:width ${t*(1-l())}ms linear`])}}}mkMsg(e){const t=this.id++,n={...this.conf,...e,content:e.content||"",onClosed:t=>{(null==e?void 0:e.onClosed)&&e.onClosed(t)},beforeClose:async n=>{if(null!=e&&e.beforeClose){if(!await e.beforeClose(n))return!1}return this.insts.delete(t),!0}},a=this.core(n);let o=!1;const r=()=>{o||(o=!0,a.open())};n.className&&a.$el.classList.add(...n.className),n.style&&s(a.$el,n.style);const i=this.insts.values().next().value;var l;i&&(null==(l=i.progress)||l.pause(),i.close(-2));const c={...a,open:r};return this.insts.set(t,c),r(),c}}function u(e,t,n){t();const a=new p(e,n),o=(...e)=>a.fire(function(e){const t={};let n=!1;const a=e=>{switch(typeof e){case"string":n?t.text=e:(t.content=e,n=!0);break;case"number":t.timeout=e;break;case"object":Object.assign(t,e)}};for(let t=0;t<4;t++)a(e[t]);return t}(e));return o.config=a.config.bind(a),o}function b(e="1em"){return`<svg width="${e}" height="${e}" viewBox="0 0 24 24"><g stroke="currentColor"><circle cx="12" cy="12" r="9.5" fill="none" stroke-linecap="round" stroke-width="2"><animate attributeName="stroke-dasharray" calcMode="spline" dur="1.5s" keySplines="0.42,0,0.58,1;0.42,0,0.58,1;0.42,0,0.58,1" keyTimes="0;0.475;0.95;1" repeatCount="indefinite" values="0 150;42 150;42 150;42 150"/><animate attributeName="stroke-dashoffset" calcMode="spline" dur="1.5s" keySplines="0.42,0,0.58,1;0.42,0,0.58,1;0.42,0,0.58,1" keyTimes="0;0.475;0.95;1" repeatCount="indefinite" values="0;-16;-59;-59"/></circle><animateTransform attributeName="transform" dur="2s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></g></svg>`}function h(e,t){const n=o("button",a("hairline"));n.textContent=e;let r=!1;return n.onclick=async()=>{r||(r=!0,setTimeout((()=>{r&&(n.innerHTML=b("1.4em"))}),50),await t(),n.textContent=e,r=!1)},n.classList.add(a("alert-btn")),n}let y=0;function v(e){let t=m(`.${a("overlay")}`);if(t||(t=r(a("overlay")),i().append(t),g(t,(e=>{e===a("fade-in")&&(y=3),e===a("fade-out")&&(y=0,c(!1),s(t,["display: none"]))}))),e){if(y>1)return t;c(),y=2,f(t,a("fade-in")),s(t,["display: block"])}else{if(y<2)return t;y=1,f(t,a("fade-out"))}return t}const x=u((function(t){const n=r(a("alert"));let o,s=!1;if(t.content&&(n.innerHTML=`<div class="${a("alert-title")}">${t.content}</div>`),t.text||t.html){const e=r(a("alert-content"));t.html?"string"==typeof t.html?e.innerHTML=t.html:e.append(t.html):e.textContent=t.text,n.append(e)}const l=()=>{f(n,a("shake"))},c=async r=>{if(s)return void l();s=!0;if(!await t.beforeClose(r))return s=!1,void l();const i=m(`.${a("overlay")}`);return-2!==r&&v(!1),e.off(i,"click",o),f(n,a("alert-out")),new Promise((e=>{g(n,(o=>{o===a("alert-out")&&(n.remove(),t.onClosed(r),e())}))}))};if(o=()=>{c(-3)},t.cancelLabel||t.confirmLabel){const e=r(a("alert-btn-group"),a("hairline"));t.cancelLabel&&e.append(h(t.cancelLabel,(async()=>{await c(2)}))),t.confirmLabel&&e.append(h(t.confirmLabel,(async()=>{await c(1)}))),n.append(e)}return{close:c,open:()=>{e.on(v(!0),"click",o),i().append(n),f(n,a("alert-in"))},$el:n}}),(()=>{d('.gmal{--gmal-alert-bg:#fff;--gmal-overlay-bg:#00000080;--gmal-border-c:#00000017}.gmal-overlay{z-index:0;background:var(--gmal-overlay-bg);animation-duration:.3s;position:fixed;top:0;bottom:0;left:0;right:0}.gmal-alert{z-index:1;background:var(--gmal-alert-bg);border-radius:16px;flex-direction:column;justify-content:space-between;width:94%;max-width:550px;min-height:172px;margin:0 auto;animation-duration:.25s;display:flex;position:fixed;top:45%;left:0;right:0;overflow:hidden;transform:translateY(-50%)}.gmal-alert .gmal-progress{pointer-events:none;opacity:0}.gmal-alert-btn-group{justify-content:center;margin-top:1rem;display:flex;position:relative}.gmal-alert-btn-group:after{border-top-width:1px!important}.gmal-alert-btn-group .gmal-alert-btn{cursor:pointer;background:0 0;border:0;width:100%;height:48px;padding:.8em 1em;font-size:1em;font-weight:500;position:relative}.gmal-alert-btn-group .gmal-alert-btn:nth-child(2):after{border-left-width:1px}.gmal-alert-btn-group .gmal-alert-btn:hover{background-image:linear-gradient(#0000000a,#0000000a)}.gmal-hairline:after{box-sizing:border-box;pointer-events:none;content:" ";border:0 solid var(--gmal-border-c);position:absolute;top:-50%;bottom:-50%;left:-50%;right:-50%;transform:scale(.5)}.gmal-alert-content{z-index:1;color:inherit;justify-content:center;padding:1.5em 1em;font-size:1.125em;display:flex;overflow:auto}.gmal-alert-title{color:inherit;text-align:center;max-width:100%;margin:0;padding:1em 1em 0;font-size:1.75em;font-weight:600;position:relative}@keyframes gmal-alert-in{0%{opacity:0;transform:translateY(-50%)scale(.6)}to{opacity:1;transform:translateY(-50%)scale(1)}}@keyframes gmal-alert-out{to{opacity:0;transform:translateY(-50%)scale(.6)}}@keyframes gmal-shake{0%{transform:translateY(-50%)}25%{transform:translate(-8px)translateY(-50%)}50%{transform:translate(8px)translateY(-50%)}75%{transform:translate(-8px)translateY(-50%)}to{transform:translateY(-50%)}}@keyframes gmal-fade-out{to{opacity:0}}@keyframes gmal-fade-in{0%{opacity:0}to{opacity:1}}')}),{timeout:0,confirmLabel:"确定"});const w=u((function(e){const t=r(a("msg")),n=r(a("msg-main"));n.innerHTML=`<div class=${a("msg-content")}>${e.content}</div>`,t.append(n);let o=e.icon||"";"loading"===o&&(o=b());const s=r(a("icon"));return s.innerHTML=o,o&&n.prepend(s),{open:()=>{i().append(t),f(t,a("alert-in"))},close:async n=>(await e.beforeClose(n),f(t,a("alert-out")),new Promise((o=>{g(t,(r=>{r===a("alert-out")&&(t.remove(),e.onClosed(n),o())}))}))),$el:t}}),(()=>{d(".gmal{--gmal-msg-bg:#000000b3;--gmal-msg-c:#fff}.gmal-msg{z-index:2;width:-webkit-max-content;width:max-content;margin:0 auto;animation-duration:.25s;position:fixed;top:45%;left:0;right:0;transform:translateY(-50%)}.gmal-msg .gmal-progress{pointer-events:none;opacity:0}.gmal-msg-main{box-sizing:border-box;color:var(--gmal-msg-c);background:var(--gmal-msg-bg);border-radius:4px;flex-direction:column;justify-content:center;align-items:center;min-width:100px;max-width:168px;padding:12px 15px;display:flex;position:relative}.gmal-msg-main .gmal-icon{margin:10px;font-size:1.8em;line-height:1;display:block}.gmal-msg-content{text-align:center}@keyframes gmal-alert-in{0%{opacity:0;transform:translateY(-50%)scale(.6)}to{opacity:1;transform:translateY(-50%)scale(1)}}@keyframes gmal-alert-out{to{opacity:0;transform:translateY(-50%)scale(.6)}}")}));return{version:"2.0.1",alert:x,notice:u((function(e){const t=r(a("notice"));return s(t,[e.bottom?"bottom:0":"top:0",e.bottom?"--y:100%":"--y:-100%",e.background?`background:${e.background}`:"",e.color?`color:${e.color}`:""]),t.innerHTML=`<div class="${a("notice-main")}"><div class="${a("notice-content")}">${e.content}</div></div>`,{open:()=>{i().append(t),f(t,a("open"))},close:async n=>(await e.beforeClose(n),f(t,a("close")),new Promise((o=>{g(t,(r=>{r===a("close")&&(t.remove(),e.onClosed(n),o())}))}))),$el:t}}),(()=>{d(".gmal{--gmal-notice-bg:#e2e7ec;--gmal-notice-c:#333;--gmal-bar-bg:#0000000f}.gmal-notice{z-index:2;color:var(--gmal-notice-c);background:var(--gmal-notice-bg);animation-duration:.3s;position:fixed;left:0;right:0}.gmal-notice .gmal-notice-main{z-index:1;flex-direction:column;align-items:normal;display:flex;position:relative}.gmal-notice .gmal-notice-main .gmal-notice-content{text-align:center;padding:1.15em;font-weight:600}@keyframes gmal-open{0%{transform:translateY(var(--y))}to{transform:translateY(0)}}@keyframes gmal-close{0%{transform:translateY(0)}to{transform:translateY(var(--y))}}")})),message:w}}();
